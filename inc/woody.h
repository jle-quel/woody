#ifndef WOODY_H
#define WOODY_H

////////////////////////////////////////////////////////////////////////////////
/// INCLUDES 
////////////////////////////////////////////////////////////////////////////////

#include <elf.h>
#include <unistd.h>
#include <stdbool.h>
#include <stdlib.h>
#include <stdio.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <sys/mman.h>

////////////////////////////////////////////////////////////////////////////////
/// DEFINES 
////////////////////////////////////////////////////////////////////////////////

#define VALID_ARGV_SIZE 2

#define ELF_MAGIC_SIZE 4
#define ELF_MAGIC_NUMBER 1179403647

#define X86_64 2

////////////////////////////////////////////////////////////////////////////////
/// ENUMS 
////////////////////////////////////////////////////////////////////////////////

typedef enum
{
	USAGE,
	WRONG_FORMAT,
	WRONG_ARCHITECTURE,
	MALLOC_FAIL,
	WRONG_FD,
	STAT_FAIL,
	MMAP_FAIL,
	CORRUPTION,
} t_error;

////////////////////////////////////////////////////////////////////////////////
/// STRUCTS
////////////////////////////////////////////////////////////////////////////////

typedef struct
{
	int insertion;
	int new_entry;
	int old_entry;
	int filesize;
	void *ptr;
	char const *filename;
} t_elf;

typedef struct
{
	t_error const err;
	void (*f)(char const *str);
} t_vector;

////////////////////////////////////////////////////////////////////////////////
/// PROTOTYPES; 
////////////////////////////////////////////////////////////////////////////////

void error(t_error const err, char const *filename);

t_elf *get_elf(char const *filename);
void release_elf(t_elf *elf);

bool is_elf(t_elf const *elf);
bool is_x86(t_elf const *elf);
void *constructor(size_t const size);

#endif
